# 算法设计

## 使用代码测试 64 TC， 没有问题。

## 群延迟

相群移是指信号在频域中的相位对频率的导数，可以用于描述信号在频域中的相位响应随频率变化的速率。

在连续时间的情况下，相群移与时延之间存在简单的线性关系：

$$ \tau = -\frac{d\phi(f)}{df} = -\frac{d}{df}\left(\arg\{H(f)\}\right) $$

其中 $\phi(f)$ 表示信号的相位， $H(f)$ 表示信号的频率响应。因此，可以通过计算频率响应的相位的一阶导数来估计时延。

## 逆FFT

假设系统中存在n个不同的时延成分 $τ_1, τ_2, ..., τ_n$ ，每个时延成分对应的增益因子分别为 $a_1, a_2, ..., a_n$ ，那么系统的频率响应 $H(f)$ 可以表示为：

$$ H(f) = \sum_i a_i \exp(-j 2π f τ_i) $$

这个表达式描述了系统的频率响应是多个复指数项之和，每个复指数项对应一个时延成分及其增益因子。

分辨率太低，仅有 20 TC，但是可以找到几个峰值。
如何选择？
- 常规使用，不应超过 50 m，即 330 TC；
- 选时延最小的峰值，可能是干扰。伪峰，例如三个天线没有，但另一个出现更近的峰。
- 选幅度最强的峰值，可能是分辨率低导致的叠加。例在 40 和 60 上，有50、52、55 三个时延。
- 选峰值对应时延，其峰值可能是由于分辨过低导致，例真值 50 落在 40 和 60 上，其中 60 偏大。

## DOA估计

### d/ $\lambda$

根据公式 `wavelength = speed / frequency`，可以计算出载频为 2565 MHz 的电磁波的波长。其中，速度可以取光速，即 299792458 m/s。将单位转换为厘米，得到：

```
wavelength = 299792458 / (2565 * 1e6) * 100
```

因此，阵元间距为 5 cm，阵元间距与波长的比值为：

```
5 / 11.6713 ≈ 0.428
```

因此，阵元间距与波长的比值约为 0.428。


## 文献翻译

[1] J. Nikonowicz, A. Mahmood, M. I. Ashraf, E. Björnson, and M. Gidlund, “Indoor Positioning Trends in 5G-Advanced: Challenges and Solution towards Centimeter-level Accuracy.” arXiv, Dec. 25, 2022. Accessed: Apr. 10, 2023. [Online]. Available: http://arxiv.org/abs/2209.01183

IIoT（工业物联网） 用例表现出由密集工业环境中物体（称为“杂波”）的多次反射引起的恶劣信道条件。 因此，测量会受到 a) 扰乱的相位连续性，b) 相对于 LOS 传输时间的过度延迟，以及 c) 与实际 LOS 方向的角度偏差。 NLOS 引起反射后的基本相位误差； 同时，在位置方程中引入了一个显着的错误，并且 IA 搜索空间大大扩展。 因此，除非排除或减轻 NLOS 测量，否则基于 CP（载波相位） 的定位中的厘米级精度在所需时间内变得无法实现。

在具有多路径的 LOS 场景中，Rician-K 因子测量从 LOS 路径接收到的功率与从所有其他路径接收到的功率之比 [9]。 对定位有用的主要是 LOS 路径的角度，可以使用天线阵列将其与杂波区分开来。 这是一个经典的信号处理问题，导致了多信号分类算法 (MUSIC)、通过旋转不变技术 (ESPRIT) 的信号参数和空间交替广义期望最大化 (SAGE) 算法 [12]。 相关的计算复杂性和鲁棒性对实时定位具有挑战性。

将 LOS 场景与具有一个或多个强反射路径的 NLOS 环境区分开来可能具有挑战性。 估计的 Rician-K 因子可能明显高于 0dB，但主导路径可能是来自误导方向的反射。 最大接收功率、延迟扩展和出发/到达角扩展等信道特征可用于区分 LOS/NLOS 情况。 [13] 中开发了一种基于 RSRP 的 NLOS 链路识别算法，该算法使用子载波的平均 NLOS 信道功率在 LOS/NLOS 链路类型之间执行二元假设检验。

合作定位是另一种方法，其中使用来自相邻锚点的信息检测/纠正由于 NLOS 条件导致的错误距离测量。 然而，独立设备必须能够自主检测 NLOS 状态并仅使用本地信息纠正错误测量。 为此，基于接收信号强度和第一路径信息的简单分类器的概念可以被更先进的机器学习 (ML) 技术所取代 [9]。 基于 ML 的解决方案聚合了各种功能。 例如，在 NLOS 条件下，多次反射导致信号衰减更多，能量和幅度更低。 而对于 LOS，最强信号路径对应于先到，对于 NLOS，最强路径之前是弱分量。
